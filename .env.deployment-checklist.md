# üîë CHECKLIST DE VARIABLES DE ENTORNO - V3.1.2

**Para deployment en Supabase Edge Functions**

---

## üìã VARIABLES REQUERIDAS

### **1. STRIPE (CR√çTICO)**

```bash
# Stripe Secret Key (empieza con sk_test_ o sk_live_)
STRIPE_SECRET_KEY=sk_test_xxxxx

# Stripe Webhook Secret (empieza con whsec_)
# NOTA: Este se genera DESPU√âS de crear el webhook endpoint
STRIPE_WEBHOOK_SECRET_V312=whsec_xxxxx
```

**¬øD√≥nde encontrarlas?**
- Secret Key: https://dashboard.stripe.com/test/apikeys
- Webhook Secret: Se genera despu√©s (Paso 1.4 del Runbook)

---

### **2. SUPABASE (CR√çTICO)**

```bash
# URL de tu proyecto Supabase
SUPABASE_URL=https://xxxxx.supabase.co

# Anon Key (p√∫blica, empieza con eyJ)
VITE_SUPABASE_ANON_KEY=eyJxxxxx

# Service Role Key (privada, empieza con eyJ)
SUPABASE_SERVICE_ROLE_KEY=eyJxxxxx
```

**¬øD√≥nde encontrarlas?**
- Dashboard > Settings > API
- URL: Project URL
- Anon Key: anon/public key
- Service Role: service_role key (¬°NUNCA expongas esta!)

---

### **3. PRICING CONFIG (CR√çTICO)**

‚ö†Ô∏è **OBSOLETO (REV B):** Las variables `STRIPE_WORST_CASE_FEE_PERCENT` y `STRIPE_WORST_CASE_FEE_FIXED_EUR` ya no se usan.

Los valores est√°n hardcoded en `src/services/pricing/calculatePricing.ts`:
```typescript
export const STRIPE_FEE_CONFIG = {
  WORST_CASE_PERCENT: 3.5,
  WORST_CASE_FIXED_EUR: 0.25,
};
```

**No es necesario configurar estas variables de entorno.**

---

### **4. NOTIFICACIONES (OPCIONAL - Para despu√©s)**

```bash
# Twilio (SMS/WhatsApp)
TWILIO_ACCOUNT_SID=ACxxxxx
TWILIO_AUTH_TOKEN=xxxxx
TWILIO_WHATSAPP_FROM=whatsapp:+14155238886

# SendGrid (Email)
SENDGRID_API_KEY=SG.xxxxx
SENDGRID_FROM_EMAIL=noreply@parisluxejourney.com
```

**Nota:** Puedes configurar esto despu√©s. No es cr√≠tico para testing inicial.

---

## ‚úÖ CHECKLIST DE VARIABLES

### **M√çNIMO PARA STAGING:**
- [ ] `STRIPE_SECRET_KEY` (test mode)
- [ ] `SUPABASE_URL`
- [ ] `VITE_SUPABASE_ANON_KEY`
- [ ] `SUPABASE_SERVICE_ROLE_KEY`
- [ ] ~~`STRIPE_WORST_CASE_FEE_PERCENT`~~ (OBSOLETO - REV B)
- [ ] ~~`STRIPE_WORST_CASE_FEE_FIXED_EUR`~~ (OBSOLETO - REV B)

### **PARA WEBHOOKS (Despu√©s):**
- [ ] `STRIPE_WEBHOOK_SECRET_V312` (se genera al crear webhook)

### **PARA NOTIFICACIONES (Opcional):**
- [ ] `TWILIO_ACCOUNT_SID`
- [ ] `TWILIO_AUTH_TOKEN`
- [ ] `TWILIO_WHATSAPP_FROM`
- [ ] `SENDGRID_API_KEY`
- [ ] `SENDGRID_FROM_EMAIL`

---

## üìù FORMATO PARA COPIAR

Cuando tengas el .env del otro PC, copia estas l√≠neas:

```bash
# Del archivo .env del otro PC, busca y copia:

# 1. Stripe
STRIPE_SECRET_KEY=
VITE_STRIPE_PUBLISHABLE_KEY=

# 2. Supabase
SUPABASE_URL=
VITE_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# 3. Twilio (si existe)
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_WHATSAPP_FROM=

# 4. SendGrid (si existe)
SENDGRID_API_KEY=
SENDGRID_FROM_EMAIL=
```

---

## üéØ C√ìMO CONFIGURARLAS EN SUPABASE

### **Opci√≥n 1: Dashboard (Manual)**

1. Ir a: https://supabase.com/dashboard/project/[tu-proyecto]
2. Click en **Settings** (men√∫ izquierdo)
3. Click en **Edge Functions**
4. Scroll hasta **"Secrets"**
5. Click **"Add new secret"**
6. Nombre: `STRIPE_SECRET_KEY`
7. Valor: `sk_test_xxxxx`
8. Click **"Save"**
9. Repetir para cada variable

### **Opci√≥n 2: CLI (M√°s r√°pido)**

```bash
# Configurar todas de una vez
supabase secrets set STRIPE_SECRET_KEY=sk_test_xxxxx
supabase secrets set SUPABASE_URL=https://xxxxx.supabase.co
supabase secrets set VITE_SUPABASE_ANON_KEY=eyJxxxxx
supabase secrets set SUPABASE_SERVICE_ROLE_KEY=eyJxxxxx
# OBSOLETO (REV B): supabase secrets set STRIPE_WORST_CASE_FEE_PERCENT=3.5
# OBSOLETO (REV B): supabase secrets set STRIPE_WORST_CASE_FEE_FIXED_EUR=0.25

# Verificar que se guardaron
supabase secrets list
```

---

## ‚ö†Ô∏è IMPORTANTE - SEGURIDAD

### **NUNCA expongas:**
- ‚ùå `SUPABASE_SERVICE_ROLE_KEY` en frontend
- ‚ùå `STRIPE_SECRET_KEY` en frontend
- ‚ùå `TWILIO_AUTH_TOKEN` en frontend

### **S√ç puedes exponer:**
- ‚úÖ `VITE_SUPABASE_ANON_KEY` (es p√∫blica)
- ‚úÖ `VITE_STRIPE_PUBLISHABLE_KEY` (es p√∫blica)
- ‚úÖ `SUPABASE_URL` (es p√∫blica)

---

## üß™ TEST MODE vs LIVE MODE

### **Para STAGING/TESTING:**
```bash
STRIPE_SECRET_KEY=sk_test_xxxxx  # ‚Üê Empieza con sk_test_
```

### **Para PRODUCCI√ìN:**
```bash
STRIPE_SECRET_KEY=sk_live_xxxxx  # ‚Üê Empieza con sk_live_
```

**IMPORTANTE:** Usa **TEST MODE** hasta que hayas completado los 7 tests E2E.

---

## üìû CUANDO TENGAS LAS CREDENCIALES

Av√≠same y te ayudo a:
1. ‚úÖ Configurarlas en Supabase
2. ‚úÖ Verificar que est√°n correctas
3. ‚úÖ Deploy de Edge Functions
4. ‚úÖ Configurar webhook de Stripe

---

**Fecha:** _____________  
**Credenciales copiadas:** ‚òê S√ç  ‚òê NO  
**Configuradas en Supabase:** ‚òê S√ç  ‚òê NO

